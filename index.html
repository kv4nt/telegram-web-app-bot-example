<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="MobileOptimized" content="176" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="robots" content="noindex,nofollow" />
    <script src="https://telegram.org/js/telegram-web-app.js?2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.slim.min.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Glide.js/3.2.0/glide.min.js" integrity="sha512-IkLiryZhI6G4pnA3bBZzYCT9Ewk87U4DGEOz+TnRD3MrKqaUitt+ssHgn2X/sxoM7FxCP/ROUp6wcxjH/GcI5Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Glide.js/3.2.0/css/glide.core.min.css" integrity="sha512-YQlbvfX5C6Ym6fTUSZ9GZpyB3F92hmQAZTO5YjciedwAaGRI9ccNs4iw2QTCJiSPheUQZomZKHQtuwbHkA9lgw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Glide.js/3.2.0/css/glide.theme.min.css" integrity="sha512-wCwx+DYp8LDIaTem/rpXubV/C1WiNRsEVqoztV0NZm8tiTvsUeSlA/Uz02VTGSiqfzAHD4RnqVoevMcRZgYEcQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/js/bootstrap.bundle.min.js" integrity="sha512-sH8JPhKJUeA9PWk3eOcOl8U+lfZTgtBXD41q6cO/slwxGHCxKcW45K4oPCUhHG7NMB4mbKEddVmPuTXtpbCbFA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/css/bootstrap.min.css" integrity="sha512-Ez0cGzNzHR1tYAv56860NLspgUGuQw16GiOOp/I2LuTmpSK9xDXlgJz3XN4cnpXWDmkNBKXR/VDMTCnAaEooxA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="css/app.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <script>
        function setThemeClass() {
            document.documentElement.className = Telegram.WebApp.colorScheme;
        }

        function makeCatEat(resultVal) {
            if(!resultVal) {
                var currentVal = parseInt($('#eat-progress').attr('aria-valuenow')) || 0;
                if (currentVal >= 100) {
                    currentVal = -25;
                }
                var resultVal = currentVal + 25;
            }
            Telegram.WebApp.CloudStorage.setItem('eat',resultVal);
            $('#eat-progress').attr('aria-valuenow',resultVal);
            $('#eat-progress div').text(resultVal+'%');
            $('#eat-progress div').css('width',resultVal+'%');
        }

        function makeCatHappy(resultVal) {
            if(!resultVal) {
                var currentVal = parseInt($('#happy-progress').attr('aria-valuenow')) || 0;
                if (currentVal >= 100) {
                    currentVal = -10;
                }
                var resultVal = currentVal + 10;
            }
            Telegram.WebApp.CloudStorage.setItem('happy',resultVal);
            $('#happy-progress').attr('aria-valuenow',resultVal);
            $('#happy-progress div').text(resultVal+'%');
            $('#happy-progress div').css('width',resultVal+'%');
        }

        function getEatValue()
        {
            Telegram.WebApp.CloudStorage.getItem('eat',function (err,value) {
                if(!err) {
                    makeCatEat(value);
                }
            })
        }

        function getHappyValue()
        {
            Telegram.WebApp.CloudStorage.getItem('happy',function (err,value) {
                if(!err) {
                    makeCatHappy(value);
                }
            })
        }

        function getCatImage()
        {
            Telegram.WebApp.CloudStorage.getItem('catImage',function (err,value) {
                if(!err) {
                    $('#catImage').prop('src',value);
                    $('#cat-card').show();
                } else {
                    $('#cat-card').hide();
                }
            })
        }

        Telegram.WebApp.onEvent('themeChanged', setThemeClass);
        setThemeClass();

        $(document).ready(function(){
            var glide = new Glide('#intro', {
                type: 'carousel',
                perView: 1,
                focusAt: 'center',
                breakpoints: {
                    800: {
                        perView: 2
                    },
                    480: {
                        perView: 1
                    }
                }
            })

            glide.mount();
            getCharacter();
            getEatValue();
            getCatImage();
            getHappyValue();
            // $('#characterName').text(getCharacter());
            setLastEnterTime();
            // if(getCharacter()) {
            //     alert('Твой выбранный котик '+getCharacter())
            // }

        });
    </script>
    <title>21 black jack</title>
    <style>
        body {
            --bg-color: var(--tg-theme-bg-color, #fff);
            font-family: sans-serif;
            background-color: var(--bg-color);
            color: var(--tg-theme-text-color, #222);
            font-size: 14px;
            margin: 0;
            padding: 0;
            color-scheme: var(--tg-color-scheme);
        }

        body.gray {
            background-color: var(--tg-theme-secondary-bg-color, #efefef);
        }

        a {
            color: var(--tg-theme-link-color, #2678b6);
        }

        .btn {
            font-size: 14px;
            padding: 10px 17px;
        }

        .btn-primary {
            background-color: var(--tg-theme-button-color, #50a8eb);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
        }

        button {
            display: block;
            width: 100%;
            font-size: 14px;
            margin: 15px 0;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            background-color: var(--tg-theme-button-color, #50a8eb);
            color: var(--tg-theme-button-text-color, #ffffff);
            cursor: pointer;
        }

        .main-container {
            padding: 15px;
        }

        .list-header {
            text-transform: uppercase;
            font-size: .92em;
            color: var(--tg-theme-hint-color, #ccc);
            margin: 0 0 10px;
        }

        a.list-group-item,
        button.list-group-item {
            color: var(--tg-theme-text-color, #222);
        }

        .main-container p {
            margin: 0 0 10px;
        }

        .main-container pre,
        .main-container > .btn {
            margin: 0 0 7px;
        }

        .main-container pre + .hint,
        .main-container > .btn + .hint {
            text-align: center;
            margin: 0 0 15px;
        }

        button[disabled] {
            opacity: 0.6;
            cursor: auto;
            pointer-events: none;
        }

        button.close_btn {
            /*position: fixed;*/
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 0;
            margin: 0;
            padding: 16px 20px;
            text-transform: uppercase;
        }

        input[type="text"],
        .input[contenteditable] {
            display: block;
            box-sizing: border-box;
            font-size: 14px;
            width: 100%;
            padding: 12px 20px;
            margin: 15px 0;
            border: 1px solid var(--tg-theme-link-color, #000);
            background-color: var(--tg-theme-bg-color, #ffffff);
            border-radius: 4px;
            color: var(--tg-theme-text-color, #222222);
            text-align: start;
        }

        input[type="text"]::-webkit-input-placeholder {
            color: var(--tg-theme-hint-color, #ccc);
        }

        input[type="text"]::-moz-placeholder {
            color: var(--tg-theme-hint-color, #ccc);
        }

        input[type="text"]:-ms-input-placeholder {
            color: var(--tg-theme-hint-color, #ccc);
        }

        .input[data-placeholder] {
            position: relative;
        }

        .input[data-placeholder]:empty:before {
            position: absolute;
            left: 0;
            right: 0;
            content: attr(data-placeholder);
            color: var(--tg-theme-hint-color, #ccc);
            padding: 0 20px;
            font-weight: normal;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            pointer-events: none;
            z-index: -1;
        }

        section {
            padding: 15px;
            text-align: center;
            background-color: var(--bg-color, #ffffff);
        }

        section#top_sect {
            background-color: var(--tg-theme-bg-color, #ffffff);
        }

        section#top_sect.second {
            background-color: var(--tg-theme-secondary-bg-color, #efefef);
        }

        section .sect_row {
            margin: 10px 0;
        }

        section + section {
            padding: 0 15px 65px;
        }

        p {
            margin: 40px 0 15px;
        }

        ul {
            text-align: left;
        }

        li {
            color: var(--tg-theme-hint-color, #a8a8a8);
        }

        textarea {
            width: 100%;
            box-sizing: border-box;
            padding: 7px;
        }

        pre {
            background: rgba(0, 0, 0, .07);
            color: var(--tg-theme-text-color, #222);
            font-size: 12px;
            border: none;
            border-radius: 4px;
            padding: 8px;
            margin: 7px 0;
            word-break: break-word;
            white-space: pre-wrap;
            text-align: left;
        }

        .dark pre {
            background: rgba(255, 255, 255, .15);
        }

        .chat_img {
            width: 30px;
            border-radius: 15px;
            margin-right: 10px;
        }

        .columns {
            display: flex;
        }

        .columns > * {
            flex-grow: 1;
        }

        .hint {
            font-size: .8em;
            color: var(--tg-theme-hint-color, #a8a8a8);
        }

        .ok {
            color: green;
        }

        .err {
            color: red;
        }

        .status_need {
            display: none;
        }

        #fixed_wrap {
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            transform: translateY(100vh);
        }

        .viewport-container {
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            height: var(--tg-viewport-stable-height, 100vh);
            transition: height .2s ease;
        }

        .viewport-container .main-container {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .viewport-container .main-container button {
            width: auto;
        }

        .viewport-border,
        .viewport-stable_border {
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            height: var(--tg-viewport-height, 100vh);
            pointer-events: none;
        }

        .viewport-stable_border {
            height: var(--tg-viewport-stable-height, 100vh);
        }

        .viewport-border:before,
        .viewport-stable_border:before {
            content: attr(text);
            display: inline-block;
            position: absolute;
            background: gray;
            right: 0;
            top: 0;
            font-size: 7px;
            padding: 2px 4px;
            vertical-align: top;
        }

        .viewport-stable_border:before {
            background: green;
            left: 0;
            right: auto;
        }

        .viewport-border:after,
        .viewport-stable_border:after {
            content: '';
            display: block;
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            border: 2px dashed gray;
        }

        .viewport-stable_border:after {
            border-color: green;
        }

        small {
            font-size: 12px;
        }
        .small {
            font-size: 12px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }
        .table td {
            padding: 2px;
        }
        .table-bordered {
            border: 1px solid var(--tg-theme-hint-color, #ccc);
        }
        .table-bordered th, .table-bordered td {
            border: 1px solid var(--tg-theme-hint-color, #ccc);
            padding: 4px;
        }
        .table.small button {
            padding: 3px 6px;
            font-size: 12px;
            margin: 4px 0;
        }
        .table.small input {
            padding: 3px 6px;
            font-size: 12px;
            margin: 4px 0;
        }
    </style>
</head>

<body class="" style="visibility: hidden;">
<div class="row justify-content-center">
    <div class="col-auto">
        <div class="card" id="cat-card" style="width: 18rem;">
            <img src="images/characters/cat/5.jpg" id="catImage" class="card-img-top" alt="...">
            <div class="card-body">
                <h5 class="card-title text-dark character-name-top" id="characterName">Персонаж</h5>
                <h6 class="text-success">Настроение <i class="fa-solid fa-face-smile"></i></h6>
                <div class="progress" id="happy-progress" role="progressbar" aria-label="Animated striped example" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar progress-bar-striped progress-bar-animated  bg-success" style="width: 75%">75%</div>
                </div>
                <h6 class="text-danger">Жизни <i class="fa-solid fa-heart-pulse"></i></h6>
                <div class="progress" role="progressbar" aria-label="Animated striped example" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar progress-bar-striped progress-bar-animated  bg-danger" style="width: 85%">85%</div>
                </div>
                <h6 class="text-warning">Еда <i class="fa-solid fa-utensils"></i></h6>
                <div class="progress" id="eat-progress" role="progressbar" aria-label="Animated striped example" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-warning" style="width: 0%">0%</div>
                </div>
                <button onclick="makeCatEat()" class="btn btn-warning">Кормить  <i class="fa-solid fa-utensils"></i></button>
                <button onclick="makeCatHappy()" class="btn btn-success">Играть <i class="fa-solid fa-cat"></i></button>
            </div>
        </div>
    </div>
</div>
<h1 class="text-center">Выбери себе персонажа</h1>

<div id="intro" class="slider glide" style="margin-top: 30px">
    <div class="slider__track glide__track" data-glide-el="track">
        <ul class="slider__slides glide__slides">

            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/1.jpg">
                <span class="character-name">Рыжик</span>
            </li>

            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/2.jpg">
                <span class="character-name">Шоколадка</span>
            </li>

            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/3.jpg">
                <span class="character-name">Серко</span>
            </li>
            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/4.jpg">
                <span class="character-name">Светлячок</span>
            </li>
            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/5.jpg">
                <span class="character-name">Варя</span>
            </li>
            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/6.jpg">
                <span class="character-name">Светик</span>
            </li>
            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/7.jpg">
                <span class="character-name">Полосатик</span>
            </li>
            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/8.jpg">
                <span class="character-name">Морда</span>
            </li>
            <li class="slider__frame glide__slide">
                <img src="images/characters/cat/9.jpg">
                <span class="character-name">Шалун</span>
            </li>

        </ul>
    </div>
    <div data-glide-el="controls">
        <button class="slider__arrow slider__arrow--prev glide__arrow glide__arrow--prev" data-glide-dir="<">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                <path d="M0 12l10.975 11 2.848-2.828-6.176-6.176H24v-3.992H7.646l6.176-6.176L10.975 1 0 12z"/>
            </svg>
        </button>

        <button class="slider__arrow slider__arrow--next glide__arrow glide__arrow--next" data-glide-dir=">">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                <path d="M13.025 1l-2.847 2.828 6.176 6.176h-16.354v3.992h16.354l-6.176 6.176 2.847 2.828 10.975-11z"/>
            </svg>
        </button>
    </div>

    <div class="slider__bullets glide__bullets" data-glide-el="controls[nav]">

        <button class="slider__bullet glide__bullet" data-glide-dir="=0"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=1"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=2"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=3"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=4"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=5"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=6"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=7"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=8"></button>

        <button class="slider__bullet glide__bullet" data-glide-dir="=9"></button>

    </div>
    <button onclick="setCharacter();">Сохранить</button>
    <!--    <div data-glide-el="controls">-->
    <!--        <button data-glide-dir="<">prev</button>-->
    <!--        <button data-glide-dir=">">next</button>-->
    <!--    </div>-->
</div>

<div class="safe-area-border"></div>
<div class="tg-safe-area-border">
    <div class="tg-content-safe-area-border"></div>
</div>
<div class="viewport-border"></div>
<div class="viewport-stable_border"></div>

<script type="application/javascript">
    function setViewportData() {
        document.querySelector('.viewport-border').setAttribute('text', window.innerWidth + ' x ' + round(Telegram.WebApp.viewportHeight, 2))
        document.querySelector('.viewport-stable_border').setAttribute('text', window.innerWidth + ' x ' + round(Telegram.WebApp.viewportStableHeight, 2) +
            ' | is_expanded: ' + (Telegram.WebApp.isExpanded ? 'true' : 'false'));
    }

    Telegram.WebApp.setHeaderColor('secondary_bg_color');
    Telegram.WebApp.onEvent('viewportChanged', setViewportData);
    setViewportData();


    function setCharacter() {
        var catName = $('.glide__slide--active span').text();
        var catImage = $('.glide__slide--active img').prop('src');
        Telegram.WebApp.CloudStorage.setItem('character',catName);
        Telegram.WebApp.CloudStorage.setItem('catImage',catImage);
        alert('Котик '+catName+' успешно выбран!');
    }

    function getCharacter()
    {
        Telegram.WebApp.CloudStorage.getItem('character',function (err,value) {
            if(!err) {
                $('#characterName').text(value);
            }
        })
    }

    function setLastEnterTime()
    {
        Telegram.WebApp.CloudStorage.setItem('lastEnterTime',Date.now());
    }

    function round(val, d) {
        const k = Math.pow(10, d || 0);
        return Math.round(val * k) / k;
    }
</script>

</body>
</html>
